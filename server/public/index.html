<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simple CRM</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body class="bg-gray-50">
    <div x-data="crmApp()" x-cloak class="flex h-screen">
        <!-- Sidebar -->
        <div class="w-64 bg-white shadow-lg">
            <div class="p-6">
                <h1 class="text-2xl font-bold text-blue-600">Simple CRM</h1>
            </div>
            <nav class="px-4 space-y-2">
                <button @click="currentPage = 'dashboard'" 
                        :class="currentPage === 'dashboard' ? 'bg-blue-600 text-white' : 'text-gray-600 hover:bg-gray-100'"
                        class="w-full flex items-center space-x-2 p-3 rounded-lg transition-colors">
                    <span>üìä</span><span>ÂÑÄË°®Êùø</span>
                </button>
                <button @click="currentPage = 'orderForm'" 
                        :class="currentPage === 'orderForm' ? 'bg-blue-600 text-white' : 'text-gray-600 hover:bg-gray-100'"
                        class="w-full flex items-center space-x-2 p-3 rounded-lg transition-colors">
                    <span>‚ûï</span><span>Êñ∞Â¢ûË®ÇÂñÆ</span>
                </button>
                <button @click="currentPage = 'orders'; loadOrders()" 
                        :class="currentPage === 'orders' ? 'bg-blue-600 text-white' : 'text-gray-600 hover:bg-gray-100'"
                        class="w-full flex items-center space-x-2 p-3 rounded-lg transition-colors">
                    <span>üõí</span><span>Ë®ÇÂñÆÁÆ°ÁêÜ</span>
                </button>
                <button @click="currentPage = 'customers'; loadCustomers()" 
                        :class="currentPage === 'customers' ? 'bg-blue-600 text-white' : 'text-gray-600 hover:bg-gray-100'"
                        class="w-full flex items-center space-x-2 p-3 rounded-lg transition-colors">
                    <span>üë•</span><span>ÂÆ¢Êà∂ÁÆ°ÁêÜ</span>
                </button>
                <button @click="currentPage = 'afterSales'; loadPendingAfterSales()" 
                        :class="currentPage === 'afterSales' ? 'bg-blue-600 text-white' : 'text-gray-600 hover:bg-gray-100'"
                        class="w-full flex items-center space-x-2 p-3 rounded-lg transition-colors relative">
                    <span>üîî</span><span>ÂîÆÂæåÈóúÊá∑</span>
                    <span x-show="stats.pendingAfterSalesCount > 0" 
                          class="absolute right-3 bg-red-500 text-white text-xs rounded-full px-2 py-0.5"
                          x-text="stats.pendingAfterSalesCount"></span>
                </button>
                <button @click="currentPage = 'settings'; fetchOptions()" 
                        :class="currentPage === 'settings' ? 'bg-blue-600 text-white' : 'text-gray-600 hover:bg-gray-100'"
                        class="w-full flex items-center space-x-2 p-3 rounded-lg transition-colors">
                    <span>‚öôÔ∏è</span><span>Á≥ªÁµ±Ë®≠ÂÆö</span>
                </button>
            </nav>
        </div>

        <!-- Main Content -->
        <div class="flex-1 overflow-auto p-8">
            <!-- Dashboard -->
            <div x-show="currentPage === 'dashboard'" class="space-y-6">
                <h2 class="text-2xl font-bold text-gray-800">ÂÑÄË°®Êùø</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                    <div class="bg-white p-6 rounded-xl shadow-sm border">
                        <p class="text-sm text-gray-500 mb-1">Á∏ΩÂÆ¢Êà∂Êï∏</p>
                        <h3 class="text-2xl font-bold text-gray-800" x-text="stats.totalCustomers"></h3>
                    </div>
                    <div class="bg-white p-6 rounded-xl shadow-sm border">
                        <p class="text-sm text-gray-500 mb-1">Á∏ΩË®ÇÂñÆÊï∏</p>
                        <h3 class="text-2xl font-bold text-gray-800" x-text="stats.totalOrders"></h3>
                    </div>
                    <div class="bg-white p-6 rounded-xl shadow-sm border">
                        <p class="text-sm text-gray-500 mb-1">Á∏ΩÈä∑ÂîÆÈ°ç</p>
                        <h3 class="text-2xl font-bold text-gray-800">$<span x-text="stats.totalSales.toLocaleString()"></span></h3>
                    </div>
                    <div class="bg-white p-6 rounded-xl shadow-sm border">
                        <p class="text-sm text-gray-500 mb-1">ÂæÖËôïÁêÜÂîÆÂæåÈóúÊá∑</p>
                        <h3 class="text-2xl font-bold text-red-600" x-text="stats.pendingAfterSalesCount"></h3>
                    </div>
                </div>
            </div>

            <!-- Settings -->
            <div x-show="currentPage === 'settings'" class="space-y-6">
                <h2 class="text-2xl font-bold text-gray-800">Á≥ªÁµ±Ë®≠ÂÆö</h2>
                
                <!-- Products -->
                <div class="bg-white p-6 rounded-xl shadow-sm border">
                    <h3 class="text-lg font-semibold mb-4">ÂïÜÂìÅÁÆ°ÁêÜ</h3>
                    <div class="flex gap-2 mb-4">
                        <input type="text" x-model="newProduct.name" placeholder="ÂïÜÂìÅÂêçÁ®±" class="border p-2 rounded flex-1">
                        <input type="number" x-model="newProduct.stock" placeholder="Â∫´Â≠ò" class="border p-2 rounded w-24">
                        <button @click="addProduct" class="bg-green-500 text-white px-4 py-2 rounded">Êñ∞Â¢û</button>
                    </div>
                    <table class="w-full">
                        <thead>
                            <tr class="text-left border-b">
                                <th class="pb-2">ÂêçÁ®±</th>
                                <th class="pb-2">Â∫´Â≠ò</th>
                                <th class="pb-2">Êìç‰Ωú</th>
                            </tr>
                        </thead>
                        <tbody>
                            <template x-for="p in options.products" :key="p.id">
                                <tr class="border-b">
                                    <td class="py-2" x-text="p.name"></td>
                                    <td class="py-2" x-text="p.stock"></td>
                                    <td class="py-2">
                                        <button @click="deleteProduct(p.id)" class="text-red-500">Âà™Èô§</button>
                                    </td>
                                </tr>
                            </template>
                        </tbody>
                    </table>
                </div>

                <!-- Channels -->
                <div class="bg-white p-6 rounded-xl shadow-sm border">
                    <h3 class="text-lg font-semibold mb-4">ÈÄöË∑ØÁÆ°ÁêÜ</h3>
                    <div class="flex gap-2 mb-4">
                        <input type="text" x-model="newChannel.name" placeholder="ÈÄöË∑ØÂêçÁ®±" class="border p-2 rounded flex-1">
                        <button @click="addChannel" class="bg-green-500 text-white px-4 py-2 rounded">Êñ∞Â¢û</button>
                    </div>
                    <ul>
                        <template x-for="c in options.channels" :key="c.id">
                            <li class="flex justify-between border-b py-2">
                                <span x-text="c.name"></span>
                                <button @click="deleteChannel(c.id)" class="text-red-500">Âà™Èô§</button>
                            </li>
                        </template>
                    </ul>
                </div>

                <!-- Logistics -->
                <div class="bg-white p-6 rounded-xl shadow-sm border">
                    <h3 class="text-lg font-semibold mb-4">Áâ©ÊµÅÁÆ°ÁêÜ</h3>
                    <div class="flex gap-2 mb-4">
                        <input type="text" x-model="newLogistics.name" placeholder="Áâ©ÊµÅÂêçÁ®±" class="border p-2 rounded flex-1">
                        <button @click="addLogistics" class="bg-green-500 text-white px-4 py-2 rounded">Êñ∞Â¢û</button>
                    </div>
                    <ul>
                        <template x-for="l in options.logistics" :key="l.id">
                            <li class="flex justify-between border-b py-2">
                                <span x-text="l.name"></span>
                                <button @click="deleteLogistics(l.id)" class="text-red-500">Âà™Èô§</button>
                            </li>
                        </template>
                    </ul>
                </div>
            </div>

            <!-- Order Form -->
            <div x-show="currentPage === 'orderForm'" class="max-w-4xl mx-auto">
                <h2 class="text-2xl font-bold text-gray-800 mb-6">Êñ∞Â¢ûË®ÇÂñÆ</h2>
                <form @submit.prevent="submitOrder" class="bg-white p-8 rounded-xl shadow-sm space-y-6">
                    <!-- Customer Info -->
                    <div class="space-y-4">
                        <h3 class="text-lg font-semibold text-gray-700 border-b pb-2">ÂÆ¢Êà∂Ë≥áË®ä (Ëº∏ÂÖ•ÈõªË©±Ëá™ÂãïÂ∏∂ÂÖ•)</h3>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700">ÈõªË©± <span class="text-red-500">*</span></label>
                                <input type="text" required x-model="orderForm.phone" @input.debounce.500ms="lookupCustomer" 
                                       class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 border p-2">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700">ÂßìÂêç <span class="text-red-500">*</span></label>
                                <input type="text" required x-model="orderForm.name" 
                                       class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 border p-2">
                            </div>
                            <div class="md:col-span-3">
                                <label class="block text-sm font-medium text-gray-700">Âú∞ÂùÄ</label>
                                <input type="text" x-model="orderForm.address" 
                                       class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 border p-2">
                            </div>
                        </div>
                    </div>

                    <!-- Order Info -->
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div class="space-y-4">
                            <h3 class="text-lg font-semibold text-gray-700 border-b pb-2">Ë®ÇÂñÆË≥áË®ä</h3>
                            <div>
                                <label class="block text-sm font-medium text-gray-700">Ë®ÇÂñÆÁ∑®Ëôü <span class="text-red-500">*</span></label>
                                <input type="text" required x-model="orderForm.orderId" 
                                       class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 border p-2">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700">Êó•Êúü <span class="text-red-500">*</span></label>
                                <input type="date" required x-model="orderForm.date" 
                                       class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 border p-2">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700">ÈÄöË∑Ø</label>
                                <input list="channels" x-model="orderForm.channel" 
                                       class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 border p-2">
                                <datalist id="channels">
                                    <template x-for="option in options.channels" :key="option.id">
                                        <option :value="option.name"></option>
                                    </template>
                                </datalist>
                            </div>
                        </div>

                        <div class="space-y-4">
                            <h3 class="text-lg font-semibold text-gray-700 border-b pb-2">ÂïÜÂìÅËàáÁâ©ÊµÅ</h3>
                            <div>
                                <label class="block text-sm font-medium text-gray-700">ÂïÜÂìÅÂêçÁ®±</label>
                                <input list="products" x-model="orderForm.productName" 
                                       class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 border p-2">
                                <datalist id="products">
                                    <template x-for="option in options.products" :key="option.id">
                                        <option :value="option.name" x-text="`${option.name} (Â∫´Â≠ò: ${option.stock})`"></option>
                                    </template>
                                </datalist>
                            </div>
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700">Êï∏Èáè</label>
                                    <input type="number" x-model="orderForm.quantity" 
                                           class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 border p-2">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700">Èä∑ÂîÆÈáëÈ°ç</label>
                                    <input type="number" x-model="orderForm.amount" 
                                           class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 border p-2">
                                </div>
                            </div>
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700">ÈÅãË≤ª</label>
                                    <input type="number" x-model="orderForm.shippingFee" 
                                           class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 border p-2">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700">Áâ©ÊµÅ</label>
                                    <input list="logistics" x-model="orderForm.logistics" 
                                           class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 border p-2">
                                    <datalist id="logistics">
                                        <template x-for="option in options.logistics" :key="option.id">
                                            <option :value="option.name"></option>
                                        </template>
                                    </datalist>
                                </div>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700">Âà∞Ë≤®Êó•Êúü</label>
                                <input type="date" x-model="orderForm.arrivalDate" 
                                       class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 border p-2">
                            </div>
                        </div>
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-gray-700">ÂÇôË®ª</label>
                        <textarea x-model="orderForm.remarks" rows="3"
                                  class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 border p-2"></textarea>
                    </div>

                    <div class="flex justify-end">
                        <button type="submit" class="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors">
                            Âª∫Á´ãË®ÇÂñÆ
                        </button>
                    </div>
                </form>
            </div>

            <!-- Orders List -->
            <div x-show="currentPage === 'orders'" class="space-y-6">
                <div class="flex justify-between items-center">
                    <h2 class="text-2xl font-bold text-gray-800">Ë®ÇÂñÆÁÆ°ÁêÜ</h2>
                    <div class="flex items-center space-x-2">
                        <button @click="exportOrders()" class="px-3 py-2 bg-green-600 text-white rounded hover:bg-green-700">ÂåØÂá∫</button>
                        <button @click="downloadOrdersTemplate()" class="px-3 py-2 bg-purple-600 text-white rounded hover:bg-purple-700">Ê®°Êùø</button>
                        <button @click="triggerOrdersImport()" class="px-3 py-2 bg-blue-600 text-white rounded hover:bg-blue-700">ÂåØÂÖ•</button>
                        <input type="file" x-ref="ordersImportFile" @change="importOrders($event)" accept=".xlsx,.xls" class="hidden">
                        <input type="text" x-model="searchOrders" @input.debounce.300ms="loadOrders" 
                               placeholder="ÊêúÂ∞ãË®ÇÂñÆÁ∑®Ëôü„ÄÅÂÆ¢Êà∂..." 
                               class="px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                </div>
                <div class="bg-white rounded-xl shadow-sm overflow-hidden">
                    <table class="min-w-full divide-y divide-gray-200">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Ë®ÇÂñÆÁ∑®Ëôü</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Êó•Êúü</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">ÂÆ¢Êà∂</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">ÂïÜÂìÅ</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">ÈáëÈ°ç</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">ÁãÄÊÖã</th>
                            </tr>
                        </thead>
                        <tbody class="bg-white divide-y divide-gray-200">
                            <template x-for="order in orders.data" :key="order.id">
                                <tr class="hover:bg-gray-50">
                                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium" x-text="order.orderId"></td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm" x-text="new Date(order.date).toLocaleDateString()"></td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm" x-text="order.customer.name"></td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm" x-text="order.productName"></td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm">$<span x-text="order.amount"></span></td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm">
                                        <span x-show="order.arrivalDate" class="px-2 py-1 text-xs rounded-full bg-green-100 text-green-800">Â∑≤Âà∞Ë≤®</span>
                                        <span x-show="!order.arrivalDate" class="px-2 py-1 text-xs rounded-full bg-yellow-100 text-yellow-800">ÈÅãÈÄÅ‰∏≠</span>
                                    </td>
                                </tr>
                            </template>
                        </tbody>
                    </table>
                    <!-- Pagination -->
                    <div class="px-6 py-3 border-t flex justify-between items-center">
                        <div class="text-sm text-gray-700">
                            ÂÖ± <span x-text="orders.pagination.total"></span> Á≠Ü
                        </div>
                        <div class="flex space-x-2">
                            <button @click="ordersPage > 1 && (ordersPage--, loadOrders())" 
                                    :disabled="ordersPage === 1"
                                    class="px-3 py-1 border rounded disabled:opacity-50">‰∏ä‰∏ÄÈ†Å</button>
                            <span class="px-3 py-1" x-text="`${ordersPage} / ${orders.pagination.totalPages}`"></span>
                            <button @click="ordersPage < orders.pagination.totalPages && (ordersPage++, loadOrders())" 
                                    :disabled="ordersPage === orders.pagination.totalPages"
                                    class="px-3 py-1 border rounded disabled:opacity-50">‰∏ã‰∏ÄÈ†Å</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Customers List -->
            <div x-show="currentPage === 'customers'" class="space-y-6">
                <div class="flex justify-between items-center">
                    <h2 class="text-2xl font-bold text-gray-800">ÂÆ¢Êà∂ÁÆ°ÁêÜ</h2>
                    <div class="flex items-center space-x-2">
                        <button @click="exportCustomers()" class="px-3 py-2 bg-green-600 text-white rounded hover:bg-green-700">ÂåØÂá∫</button>
                        <button @click="downloadCustomersTemplate()" class="px-3 py-2 bg-purple-600 text-white rounded hover:bg-purple-700">Ê®°Êùø</button>
                        <button @click="triggerCustomersImport()" class="px-3 py-2 bg-blue-600 text-white rounded hover:bg-blue-700">ÂåØÂÖ•</button>
                        <input type="file" x-ref="customersImportFile" @change="importCustomers($event)" accept=".xlsx,.xls" class="hidden">
                        <input type="text" x-model="searchCustomers" @input.debounce.300ms="loadCustomers" 
                               placeholder="ÊêúÂ∞ãÂßìÂêç„ÄÅÈõªË©±..." 
                               class="px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                </div>
                <div class="bg-white rounded-xl shadow-sm overflow-hidden">
                    <table class="min-w-full divide-y divide-gray-200">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">ÂßìÂêç</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">ÈõªË©±</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Âú∞ÂùÄ</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">ÁóáÁãÄ</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Ë®ÇÂñÆÊï∏</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Êìç‰Ωú</th>
                            </tr>
                        </thead>
                        <tbody class="bg-white divide-y divide-gray-200">
                            <template x-for="customer in customers.data" :key="customer.id">
                                <tr class="hover:bg-gray-50">
                                    <template x-if="editingCustomerId === customer.id">
                                        <td class="px-6 py-4 text-sm" colspan="6">
                                            <div class="space-y-3">
                                                <div class="grid grid-cols-2 gap-3">
                                                    <input type="text" x-model="customerEdit.name" placeholder="ÂßìÂêç" class="border p-2 rounded">
                                                    <input type="text" x-model="customerEdit.phone" placeholder="ÈõªË©±" class="border p-2 rounded">
                                                </div>
                                                <input type="text" x-model="customerEdit.address" placeholder="Âú∞ÂùÄ" class="border p-2 rounded w-full">
                                                <textarea x-model="customerEdit.symptoms" placeholder="ÁóáÁãÄ" class="border p-2 rounded w-full" rows="2"></textarea>
                                                <div class="flex space-x-2">
                                                    <button @click="saveCustomerEdit()" class="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700">ÂÑ≤Â≠ò</button>
                                                    <button @click="cancelEditCustomer()" class="px-4 py-2 bg-gray-300 rounded hover:bg-gray-400">ÂèñÊ∂à</button>
                                                </div>
                                            </div>
                                        </td>
                                    </template>
                                    <template x-if="editingCustomerId !== customer.id">
                                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium" x-text="customer.name"></td>
                                    </template>
                                    <template x-if="editingCustomerId !== customer.id">
                                        <td class="px-6 py-4 whitespace-nowrap text-sm" x-text="customer.phone"></td>
                                    </template>
                                    <template x-if="editingCustomerId !== customer.id">
                                        <td class="px-6 py-4 whitespace-nowrap text-sm" x-text="customer.address"></td>
                                    </template>
                                    <template x-if="editingCustomerId !== customer.id">
                                        <td class="px-6 py-4 text-sm" x-text="customer.symptoms || '-'"></td>
                                    </template>
                                    <template x-if="editingCustomerId !== customer.id">
                                        <td class="px-6 py-4 whitespace-nowrap text-sm" x-text="customer.orders.length"></td>
                                    </template>
                                    <template x-if="editingCustomerId !== customer.id">
                                        <td class="px-6 py-4 whitespace-nowrap text-sm">
                                            <button @click="startEditCustomer(customer)" class="text-blue-600 hover:text-blue-800">Á∑®ËºØ</button>
                                        </td>
                                    </template>
                                </tr>
                            </template>
                        </tbody>
                    </table>
                    <!-- Pagination -->
                    <div class="px-6 py-3 border-t flex justify-between items-center">
                        <div class="text-sm text-gray-700">
                            ÂÖ± <span x-text="customers.pagination.total"></span> Á≠Ü
                        </div>
                        <div class="flex space-x-2">
                            <button @click="customersPage > 1 && (customersPage--, loadCustomers())" 
                                    :disabled="customersPage === 1"
                                    class="px-3 py-1 border rounded disabled:opacity-50">‰∏ä‰∏ÄÈ†Å</button>
                            <span class="px-3 py-1" x-text="`${customersPage} / ${customers.pagination.totalPages}`"></span>
                            <button @click="customersPage < customers.pagination.totalPages && (customersPage++, loadCustomers())" 
                                    :disabled="customersPage === customers.pagination.totalPages"
                                    class="px-3 py-1 border rounded disabled:opacity-50">‰∏ã‰∏ÄÈ†Å</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- After Sales -->
            <div x-show="currentPage === 'afterSales'" class="space-y-6">
                <div class="flex items-center space-x-3">
                    <h2 class="text-2xl font-bold text-gray-800">ÂîÆÂæåÈóúÊá∑ÂæÖËæ¶‰∫ãÈ†Ö</h2>
                    <span class="bg-red-100 text-red-800 text-sm font-medium px-2.5 py-0.5 rounded-full" x-text="`${pendingAfterSales.length} Á≠ÜÂæÖËôïÁêÜ`"></span>
                </div>
                <div class="bg-white rounded-xl shadow-sm overflow-hidden">
                    <template x-if="pendingAfterSales.length === 0">
                        <div class="p-12 text-center text-gray-500">
                            <div class="text-6xl mb-4">‚úì</div>
                            <p class="text-lg">Â§™Ê£í‰∫ÜÔºÅÁõÆÂâçÊ≤íÊúâÈúÄË¶ÅËôïÁêÜÁöÑÂîÆÂæåÈóúÊá∑„ÄÇ</p>
                        </div>
                    </template>
                    <div class="divide-y divide-gray-200">
                        <template x-for="order in pendingAfterSales" :key="order.id">
                            <div class="p-6 hover:bg-gray-50">
                                <div class="flex flex-col md:flex-row justify-between items-start gap-6">
                                    <div class="flex-1 space-y-3">
                                        <div class="flex items-center space-x-2">
                                            <span class="text-red-500">‚ö†Ô∏è</span>
                                            <span class="font-bold text-lg">Ë®ÇÂñÆ #<span x-text="order.orderId"></span></span>
                                            <span class="text-sm text-gray-500 bg-gray-100 px-2 py-1 rounded">
                                                Âà∞Ë≤®: <span x-text="new Date(order.arrivalDate).toLocaleDateString()"></span>
                                            </span>
                                        </div>
                                        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 text-sm text-gray-600">
                                            <div>üìû <span class="font-medium" x-text="order.customer.name"></span> (<span x-text="order.customer.phone"></span>)</div>
                                            <div>üì¶ <span x-text="order.productName"></span> x<span x-text="order.quantity"></span></div>
                                        </div>
                                    </div>
                                    <div class="w-full md:w-1/3 bg-gray-50 p-4 rounded-lg border">
                                        <label class="block text-sm font-medium text-gray-700 mb-2">ÂîÆÂæåÈóúÊá∑Á¥ÄÈåÑ (Â°´ÂØ´ÂæåÂç≥ÂÆåÊàê)</label>
                                        <textarea :id="'notes-' + order.id" rows="2" 
                                                  class="w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 border p-2 text-sm mb-2"
                                                  placeholder="‰æãÂ¶ÇÔºöÂÆ¢Êà∂Ë°®Á§∫‰ΩøÁî®ÁãÄÊ≥ÅËâØÂ•Ω..."></textarea>
                                        <button @click="updateAfterSales(order.id, document.getElementById('notes-' + order.id).value)" 
                                                class="w-full bg-blue-600 text-white px-4 py-1.5 rounded-md hover:bg-blue-700 text-sm">
                                            ÂÑ≤Â≠òÁ¥ÄÈåÑ
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </template>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="/js/app.js"></script>
</body>
</html>
